<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test for the single-&gt; joint linear regression calculations â€¢ coloc</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Test for the single-&gt; joint linear regression calculations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coloc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/colocqq-tests.html">Test for the single-&gt; joint linear regression calculations</a>
    </li>
    <li>
      <a href="../articles/vignette.html">Coloc: a package for colocalisation analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chr1swallace/coloc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Test for the single-&gt; joint linear regression calculations</h1>
                        <h4 class="author">Chris Wallace</h4>
            
            <h4 class="date">2018-09-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/master/vignettes/colocqq-tests.Rmd"><code>vignettes/colocqq-tests.Rmd</code></a></small>
      <div class="hidden name"><code>colocqq-tests.Rmd</code></div>

    </div>

    
    
<div id="joint-regression-back-calculation-for-quantitative-traits" class="section level2">
<h2 class="hasAnchor">
<a href="#joint-regression-back-calculation-for-quantitative-traits" class="anchor"></a>Joint regression back-calculation for quantitative traits</h2>
<p>When estimated regression coefficients for two quantitative traits are not independent, because they have been estimated using the same individuals, coloc.abf() is invalid, as it assumes the joint likelihood for both traits can be partitioned into the products of likelihoods for each. Unfortunately, it is also not common to provide the joint likelihood summary statistics, and would be wasteful in terms of space. But fortunately, the summary information is usually sufficient for exact reconstruction of the joint likelihood summary statistics. This vignette demonstrates that code implementing that reconstruction works, using simulated data. A user does not need to call these functions, they are called within <code>colocqq()</code>. load coloc</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coloc)
<span class="kw">library</span>(bindata)
<span class="kw">library</span>(data.table)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(ggplot2)</code></pre></div>
</div>
<div id="the-case-of-one-snp" class="section level2">
<h2 class="hasAnchor">
<a href="#the-case-of-one-snp" class="anchor"></a>The case of one SNP</h2>
<p>here we only need to calculate var(b1,b2) where b1, b2 are the regression coefficients for traits 1 and 2 against the same SNP (which we will call X)</p>
<p>this is a function to simulate genotype data, calculate joint univariate regression directly, and calculate it via reconstruction from the single-trait univariate regression summary statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simmer &lt;-<span class="st"> </span><span class="cf">function</span>() {
    maf<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">20</span> <span class="co"># snp1</span>
    maf<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">20</span> <span class="co"># snp2</span>
    N &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dv">1</span>)<span class="op">*</span><span class="dv">1000</span>
    ## rho &lt;- sample(c(0,0.3),1)
    rho &lt;-<span class="st"> </span><span class="dv">0</span>
    mrho &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
    ## cat(maf.1,maf.2,rho,"\n")
    h1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/bindata/topics/rmvbin">rmvbin</a></span>(N, <span class="dt">margprob =</span> <span class="kw">c</span>(maf<span class="fl">.1</span>, maf<span class="fl">.2</span>), <span class="dt">bincorr =</span> mrho)
    h2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/bindata/topics/rmvbin">rmvbin</a></span>(N, <span class="dt">margprob =</span> <span class="kw">c</span>(maf<span class="fl">.1</span>, maf<span class="fl">.2</span>), <span class="dt">bincorr =</span> mrho)
    x &lt;-<span class="st"> </span>h1 <span class="op">+</span><span class="st"> </span>h2
    mu1 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">1</span>)
    mu2 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">1</span>)
    y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, x[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>mu1 <span class="op">+</span><span class="st"> </span>x[,<span class="dv">2</span>], <span class="dt">sd=</span><span class="dv">4</span>)
    y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, x[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>mu2 <span class="op">+</span><span class="st"> </span>x[,<span class="dv">2</span>], <span class="dt">sd=</span><span class="dv">2</span>)
    m &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">cbind</span>(y1,y2) <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>])
    m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>])
    m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y2 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>])

    ## summary stats
    b1 &lt;-<span class="st"> </span><span class="kw">coef</span>(m1)[<span class="dv">2</span>]
    b2 &lt;-<span class="st"> </span><span class="kw">coef</span>(m2)[<span class="dv">2</span>]
    vb1 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m1)[<span class="dv">2</span>,<span class="dv">2</span>]
    vb2 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m2)[<span class="dv">2</span>,<span class="dv">2</span>]
    fx &lt;-<span class="st"> </span><span class="kw">mean</span>(x[,<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
    v1 &lt;-<span class="st"> </span><span class="kw">var</span>(y1)
    v2 &lt;-<span class="st"> </span><span class="kw">var</span>(y2)
    eta=<span class="kw">cor</span>(y1,y2)

    res &lt;-<span class="st"> </span>coloc<span class="op">:::</span><span class="kw"><a href="../reference/qq.onesnp.html">qq.onesnp</a></span>(b1,b2,vb1,vb2,fx,v1,v2,eta,N)<span class="op">*</span><span class="kw">sqrt</span>(vb1<span class="op">*</span>vb2)
    <span class="kw">names</span>(res) &lt;-<span class="st"> "est.vb1b2"</span>
    ## names(res) &lt;- paste0("est.",names(res))
    ## target &lt;- c(b1=b1,b2=b2,vb1=vb1,vb2=vb2,vb1b2=vcov(m)[4,2])
    target &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">vb1b2=</span><span class="kw">vcov</span>(m)[<span class="dv">4</span>,<span class="dv">2</span>]) 
    <span class="kw"><a href="http://www.rdocumentation.org/packages/data.table/topics/copy">copy</a></span>(<span class="kw">do.call</span>(<span class="st">"data.table"</span>,
            <span class="kw">c</span>(<span class="kw">list</span>(<span class="dt">maf.1=</span>maf<span class="fl">.1</span>,
                   <span class="dt">maf.2=</span>maf<span class="fl">.2</span>,
                   <span class="dt">N=</span>N,
                   <span class="dt">eta=</span>eta),
              <span class="kw">as.list</span>(target),
              <span class="kw">as.list</span>(res)
              )))
}</code></pre></div>
<p>each run produces output like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">simmer</span>()  </code></pre></div>
<pre><code>##    maf.1 maf.2    N       eta        vb1b2    est.vb1b2
## 1:  0.45   0.3 5000 0.1455323 0.0001816654 0.0001818118</code></pre>
<p>we will run it lots of times, and compare output</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) <span class="kw">simmer</span>())  <span class="op">%&gt;%</span><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/data.table/topics/rbindlist">rbindlist</a></span>()</code></pre></div>
<p>numerically almost identical results</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(res[,<span class="st">"vb1b2"</span>],res[,<span class="st">"est.vb1b2"</span>]) <span class="co"># 0.984</span></code></pre></div>
<pre><code>##       est.vb1b2
## vb1b2 0.9999799</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(res,<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>vb1b2,<span class="dt">y=</span>est.vb1b2)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_abline</a></span>() </code></pre></div>
<p><img src="colocqq-tests_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">################################################################################</code></pre></div>
</div>
<div id="now-try-same-for-joint-2-snp-model-from-4-univariates" class="section level2">
<h2 class="hasAnchor">
<a href="#now-try-same-for-joint-2-snp-model-from-4-univariates" class="anchor"></a>now try same for joint 2 snp model from 4 univariates</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simmer &lt;-<span class="st"> </span><span class="cf">function</span>() {
    maf<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">20</span> <span class="co"># snp1</span>
    maf<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">20</span> <span class="co"># snp2</span>
    N &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dv">1</span>)<span class="op">*</span><span class="dv">1000</span>
    ## rho &lt;- sample(c(0,0.3),1)
    rho &lt;-<span class="st"> </span><span class="kw">max</span>(maf<span class="fl">.1</span>,maf<span class="fl">.2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>),<span class="dv">1</span>)<span class="op">/</span><span class="dv">10</span> 
    mrho &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
    ## cat(maf.1,maf.2,rho,"\n")
    h1 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/bindata/topics/rmvbin">rmvbin</a></span>(N, <span class="dt">margprob =</span> <span class="kw">c</span>(maf<span class="fl">.1</span>, maf<span class="fl">.2</span>), <span class="dt">bincorr =</span> mrho)
    h2 &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/bindata/topics/rmvbin">rmvbin</a></span>(N, <span class="dt">margprob =</span> <span class="kw">c</span>(maf<span class="fl">.1</span>, maf<span class="fl">.2</span>), <span class="dt">bincorr =</span> mrho)
    x &lt;-<span class="st"> </span>h1 <span class="op">+</span><span class="st"> </span>h2
    mu1 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">1</span>)
    mu2 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">1</span>)
    y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, x[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>mu1 <span class="op">+</span><span class="st"> </span>x[,<span class="dv">2</span>], <span class="dt">sd=</span><span class="dv">4</span>)
    y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, x[,<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>mu2 <span class="op">+</span><span class="st"> </span>x[,<span class="dv">2</span>], <span class="dt">sd=</span><span class="dv">2</span>)
    m &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">cbind</span>(y1,y2) <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>]<span class="op">+</span>x[,<span class="dv">2</span>])
    m11 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>])
    m21 &lt;-<span class="st"> </span><span class="kw">lm</span>(y2 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">1</span>])
    m12 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">2</span>])
    m22 &lt;-<span class="st"> </span><span class="kw">lm</span>(y2 <span class="op">~</span><span class="st"> </span>x[,<span class="dv">2</span>])

    ## summary stats
    b1 &lt;-<span class="st"> </span><span class="kw">coef</span>(m11)[<span class="dv">2</span>]
    b2 &lt;-<span class="st"> </span><span class="kw">coef</span>(m21)[<span class="dv">2</span>]
    g1 &lt;-<span class="st"> </span><span class="kw">coef</span>(m12)[<span class="dv">2</span>]
    g2 &lt;-<span class="st"> </span><span class="kw">coef</span>(m22)[<span class="dv">2</span>]
    vb1 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m11)[<span class="dv">2</span>,<span class="dv">2</span>]
    vb2 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m21)[<span class="dv">2</span>,<span class="dv">2</span>]
    vg1 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m12)[<span class="dv">2</span>,<span class="dv">2</span>]
    vg2 &lt;-<span class="st"> </span><span class="kw">vcov</span>(m22)[<span class="dv">2</span>,<span class="dv">2</span>]
    fx &lt;-<span class="st"> </span><span class="kw">mean</span>(x[,<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
    fz &lt;-<span class="st"> </span><span class="kw">mean</span>(x[,<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span>
    v1 &lt;-<span class="st"> </span><span class="kw">var</span>(y1)
    v2 &lt;-<span class="st"> </span><span class="kw">var</span>(y2)
    eta=<span class="kw">cor</span>(y1,y2)
    rho=<span class="kw">cor</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>])
    
    res &lt;-<span class="st"> </span>coloc<span class="op">:::</span><span class="kw"><a href="../reference/qq.twosnp.html">qq.twosnp</a></span>(b1,b2,g1,g2,vb1,vb2,vg1,vg2,fx,fz,rho,v1,v2,eta,N)
    <span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"est."</span>,<span class="kw">names</span>(res))
    target &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">b1=</span><span class="kw">coef</span>(m)[<span class="dv">2</span>,<span class="dv">1</span>],
                <span class="dt">b2=</span><span class="kw">coef</span>(m)[<span class="dv">2</span>,<span class="dv">2</span>],
                <span class="dt">g1=</span><span class="kw">coef</span>(m)[<span class="dv">3</span>,<span class="dv">1</span>],
                <span class="dt">g2=</span><span class="kw">coef</span>(m)[<span class="dv">3</span>,<span class="dv">2</span>],
                <span class="dt">vb1=</span><span class="kw">vcov</span>(m)[<span class="dv">2</span>,<span class="dv">2</span>],
                <span class="dt">vb2=</span><span class="kw">vcov</span>(m)[<span class="dv">5</span>,<span class="dv">5</span>],
                <span class="dt">vg1=</span><span class="kw">vcov</span>(m)[<span class="dv">3</span>,<span class="dv">3</span>],
                <span class="dt">vg2=</span><span class="kw">vcov</span>(m)[<span class="dv">6</span>,<span class="dv">6</span>],
                <span class="dt">vb1b2=</span><span class="kw">vcov</span>(m)[<span class="dv">2</span>,<span class="dv">5</span>],
                <span class="dt">vg1g2=</span><span class="kw">vcov</span>(m)[<span class="dv">3</span>,<span class="dv">6</span>],
                <span class="dt">vb1g1=</span><span class="kw">vcov</span>(m)[<span class="dv">2</span>,<span class="dv">3</span>],
                <span class="dt">vb2g2=</span><span class="kw">vcov</span>(m)[<span class="dv">5</span>,<span class="dv">6</span>],
                <span class="dt">vb1g2=</span><span class="kw">vcov</span>(m)[<span class="dv">2</span>,<span class="dv">6</span>])
    <span class="kw"><a href="http://www.rdocumentation.org/packages/data.table/topics/copy">copy</a></span>(<span class="kw">do.call</span>(<span class="st">"data.table"</span>,
            <span class="kw">c</span>(<span class="kw">list</span>(<span class="dt">maf.1=</span>maf<span class="fl">.1</span>,
                   <span class="dt">maf.2=</span>maf<span class="fl">.2</span>,
                   <span class="dt">rho=</span>rho,
                   <span class="dt">N=</span>N,
                   <span class="dt">eta=</span>eta),
              <span class="kw">as.list</span>(target),
              <span class="kw">as.list</span>(res)
              )))
}

res &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) <span class="kw">simmer</span>())  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/data.table/topics/rbindlist">rbindlist</a></span>()</code></pre></div>
<p>this time there are several quantities to calculate they still correlate very well, between directly caclulated and back-calculated</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cn &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">"est"</span>,<span class="kw">names</span>(res),<span class="dt">value=</span><span class="ot">TRUE</span>)
ecn &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">"est."</span>,<span class="st">""</span>,cn)
<span class="kw">structure</span>(<span class="kw">diag</span>(<span class="kw">cor</span>(res[,cn,<span class="dt">with=</span><span class="ot">FALSE</span>],res[,ecn,<span class="dt">with=</span><span class="ot">FALSE</span>])),
          <span class="dt">names=</span>ecn)</code></pre></div>
<pre><code>##        b1        b2        g1        g2       vb1       vb2     vb1b2 
## 1.0000000 1.0000000 0.9999999 0.9999997 1.0000000 0.9999991 0.9999168 
##       vg1       vg2     vg1g2     vb1g1     vb2g2     vb1g2 
## 0.9999999 0.9999984 0.9997624 1.0000000 0.9999992 0.9998546</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
tmp &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/data.table/topics/melt.data.table">melt</a></span>(res,<span class="dt">measure.vars=</span><span class="kw">list</span>(<span class="dt">direct=</span>cn,<span class="dt">backcalc=</span>ecn))
tmp[,variable<span class="op">:</span><span class="er">=</span>cn[variable]]
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(tmp,<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>direct,<span class="dt">y=</span>backcalc)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_abline</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>variable,<span class="dt">scales=</span><span class="st">"free"</span>)</code></pre></div>
<p><img src="colocqq-tests_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#joint-regression-back-calculation-for-quantitative-traits">Joint regression back-calculation for quantitative traits</a></li>
      <li><a href="#the-case-of-one-snp">The case of one SNP</a></li>
      <li><a href="#now-try-same-for-joint-2-snp-model-from-4-univariates">now try same for joint 2 snp model from 4 univariates</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Chris Wallace, Claudia Giambartolomei.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
