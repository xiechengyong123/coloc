<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coloc: data structures • coloc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Coloc: data structures">
<meta property="og:description" content="coloc">
<meta property="og:image" content="https://chr1swallace.github.io/coloc/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_intro.html">Coloc: a package for colocalisation analyses</a>
    </li>
    <li>
      <a href="../articles/a02_data.html">Coloc: data structures</a>
    </li>
    <li>
      <a href="../articles/a03_enumeration.html">Coloc: under a single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/a04_sensitivity.html">Coloc: sensitivity to prior values</a>
    </li>
    <li>
      <a href="../articles/a06_SuSiE.html">Coloc: using SuSiE to relax the single causal variant assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chr1swallace/coloc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Coloc: data structures</h1>
                        <h4 class="author">Chris Wallace</h4>
            
            <h4 class="date">2021-06-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/master/vignettes/a02_data.Rmd"><code>vignettes/a02_data.Rmd</code></a></small>
      <div class="hidden name"><code>a02_data.Rmd</code></div>

    </div>

    
    
<div id="data-structures" class="section level1">
<h1 class="hasAnchor">
<a href="#data-structures" class="anchor"></a>Data structures</h1>
<p>The enumeration approaches to coloc <a href="a03_enumeration.Rmd"><code>coloc.abf</code></a> and <a href="a06_susie.Rmd"><code>coloc.susie</code></a> require the same data format. To be flexible, <code>coloc.abf</code> allows a wider variety of inputs, which can sometimes be confusing. This document aims to set out what ideal and acceptable data structures are, as well as covering some points on how you should select the SNPs for study.</p>
<div id="first-select-the-snps-to-study-" class="section level2">
<h2 class="hasAnchor">
<a href="#first-select-the-snps-to-study-" class="anchor"></a>First: select the SNPs to study.</h2>
<p>SNPs must * have summary data available in both studies * cover a single genomic region (perhaps defined by distance about some GWAS peak or delimited by recombination hotspots), and * represent a dense coverage of the region</p>
<p>This can result in up to 10,000 SNPs on larger regions. A single genomic region <em>does not</em> correspond to the whole genome, nor to a whole chromosome. Coloc also does not automatically split chromosomes or a genome into regions. It is assumed the user can look at their data, identify a region with overlapping GWAS signals between two studies, and decide on the set of SNPs to include. Some utilities are provided which can help check regions are sensible.</p>
<p>Please do include all SNPs you have in the region: do not trim by significance or MAF or other means. Coloc enumerates all possible configureations of shared and non-shared causal variants and evaluates their relative support; it cannot do this if it does not have all the SNPs available.</p>
</div>
<div id="a-minimum-coloc-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#a-minimum-coloc-dataset" class="anchor"></a>A minimum coloc dataset</h2>
<p>Colocalisation and fine-mapping work through evaluating approximate Bayes factors summarising evidence for association at each SNP. This requires knowing the estimated effect size <span class="math inline">\(\beta\)</span> and its uncertainty <span class="math inline">\(var(\beta)\)</span>. <span class="math inline">\(var(\beta)\)</span> is the standard error of <span class="math inline">\(\beta\)</span>, squared. It is also good practice to supply SNP names, and SNP positions.</p>
<p>We also need a prior on the true effect sizes at causal variants, which is different depending on whether you have a quantitative or case-control (binary) trait. To estimate a prior, we need to know the trait standard deviation (which allows us to interpret the scale of the estimated beta).</p>
<p>Coloc comes with test data, so you can explore the structure for a quantitative trait. Here we show the minimum dataset needed for a quantitative trait. <code><a href="../reference/check_dataset.html">check_dataset()</a></code> returns NULL if it finds no errors. It will stop with error if there are issues that absolutely must be fixed to run coloc, but may print warnings if it sees something merely suspicious - eg if there is no strong signal of association. The warning doesn’t mean you can’t run coloc - it is perfectly valid to assess that there is only evidence for association in one of your datasets, but it may alert you to check something if you <em>thought</em> there was strong association there. One common mistake is to use the standard error of beta in place of the variance of beta. If your dataset provides the standard error, simply square it to get the variance.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chr1swallace/coloc">coloc</a></span><span class="op">)</span></code></pre></div>
<pre><code>## This is a new update to coloc.</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span>
<span class="va">minimum_data</span><span class="op">=</span><span class="va">D1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"beta"</span>,<span class="st">"varbeta"</span>,<span class="st">"snp"</span>,<span class="st">"position"</span>,<span class="st">"type"</span>,<span class="st">"sdY"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">minimum_data</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 6
##  $ beta    : Named num [1:50] 0.288 0.3 0.334 0.444 0.494 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ varbeta : Named num [1:50] 0.00681 0.0105 0.00733 0.00591 0.01514 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ snp     : chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ position: int [1:50] 1 2 3 4 5 6 7 8 9 10 ...
##  $ type    : chr "quant"
##  $ sdY     : num 1.12</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">minimum_data</span>,warn.minp<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in check_dataset(minimum_data, warn.minp = 1e-10): minimum p value is: 7.6775e-09
## If this is what you expected, this is not a problem.
## If this is not as small as you expected, please check the 02_data vignette.</code></pre>
<pre><code>## NULL</code></pre>
<p>It’s also useful to plot your datasets, and check * coverage is dense * the level of association matches your expectation</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span><span class="op">(</span><span class="va">minimum_data</span><span class="op">)</span></code></pre></div>
<p><img src="a02_data_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>For a case control trait, you would need to give the <code>type</code> as “cc”:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">minimum_ccdata</span><span class="op">=</span><span class="va">D1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"beta"</span>,<span class="st">"varbeta"</span>,<span class="st">"snp"</span>,<span class="st">"position"</span><span class="op">)</span><span class="op">]</span>
<span class="va">minimum_ccdata</span><span class="op">$</span><span class="va">type</span><span class="op">=</span><span class="st">"cc"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">minimum_ccdata</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 5
##  $ beta    : Named num [1:50] 0.288 0.3 0.334 0.444 0.494 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ varbeta : Named num [1:50] 0.00681 0.0105 0.00733 0.00591 0.01514 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ snp     : chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ position: int [1:50] 1 2 3 4 5 6 7 8 9 10 ...
##  $ type    : chr "cc"</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">minimum_ccdata</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>In either case, you can see that the lengths of beta, varbeta, snp and position are the same. They are assumed to represent the same snps in the same order. If you have your data in a data.frame, you could use <code><a href="https://rdrr.io/r/base/list.html">as.list()</a></code> to convert to a list, and then add the other elements, but you cannot pass a data.frame to coloc, because elements like <code>type</code> need to be of length 1.</p>
</div>
<div id="analysing-two-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#analysing-two-datasets" class="anchor"></a>Analysing two datasets</h2>
<p>coloc is used to analyse exactly two datasets. The snp identifiers are used to match snps between datasets, and only the snps that appear in both datasets will contribute to the analysis.</p>
</div>
<div id="what-if-i-dont-have-sdy" class="section level2">
<h2 class="hasAnchor">
<a href="#what-if-i-dont-have-sdy" class="anchor"></a>What if I don’t have sdY?</h2>
<p>Often, sdY is not available for quantitative datasets. If the study say they standardised their trait to have variance 1, then you can set =sdY= to 1. Otherwise coloc can estimate it, but not needs MAF and sample size information too. So the dataset would look like:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nosdY_data</span><span class="op">=</span><span class="va">D1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"beta"</span>,<span class="st">"varbeta"</span>,<span class="st">"snp"</span>,<span class="st">"position"</span>,<span class="st">"type"</span>,<span class="st">"N"</span>,<span class="st">"MAF"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nosdY_data</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 7
##  $ beta    : Named num [1:50] 0.288 0.3 0.334 0.444 0.494 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ varbeta : Named num [1:50] 0.00681 0.0105 0.00733 0.00591 0.01514 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ snp     : chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ position: int [1:50] 1 2 3 4 5 6 7 8 9 10 ...
##  $ type    : chr "quant"
##  $ N       : int 1000
##  $ MAF     : Named num [1:50] 0.131 0.083 0.122 0.146 0.048 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">nosdY_data</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="what-if-i-dont-have-beta-andor-varbeta" class="section level2">
<h2 class="hasAnchor">
<a href="#what-if-i-dont-have-beta-andor-varbeta" class="anchor"></a>What if I don’t have beta and/or varbeta?</h2>
<p>beta and varbeta are preferred. Please supply them if you have them, especially in the case of imputed data where they capture the effects of imperfect imputation. But if you don’t have them, coloc can estimate them, given p values, MAF, sample size and, if case-control data, the fraction of samples that are cases:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nobeta_data</span><span class="op">=</span><span class="va">D1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MAF"</span>,<span class="st">"snp"</span>,<span class="st">"position"</span>,<span class="st">"type"</span>,<span class="st">"sdY"</span>,<span class="st">"N"</span><span class="op">)</span><span class="op">]</span>
<span class="va">nobeta_data</span><span class="op">$</span><span class="va">pvalues</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">D1</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">D1</span><span class="op">$</span><span class="va">varbeta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nobeta_data</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 7
##  $ MAF     : Named num [1:50] 0.131 0.083 0.122 0.146 0.048 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ snp     : chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ position: int [1:50] 1 2 3 4 5 6 7 8 9 10 ...
##  $ type    : chr "quant"
##  $ sdY     : num 1.12
##  $ N       : int 1000
##  $ pvalues : Named num [1:50] 4.78e-04 3.45e-03 9.70e-05 7.68e-09 5.94e-05 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">nobeta_data</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nobeta_ccdata</span><span class="op">=</span><span class="va">D1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MAF"</span>,<span class="st">"snp"</span>,<span class="st">"position"</span>,<span class="st">"N"</span><span class="op">)</span><span class="op">]</span>
<span class="va">nobeta_ccdata</span><span class="op">$</span><span class="va">pvalues</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">D1</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">D1</span><span class="op">$</span><span class="va">varbeta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="va">nobeta_ccdata</span><span class="op">$</span><span class="va">type</span><span class="op">=</span><span class="st">"cc"</span>
<span class="va">nobeta_ccdata</span><span class="op">$</span><span class="va">s</span><span class="op">=</span><span class="fl">0.5</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nobeta_ccdata</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 7
##  $ MAF     : Named num [1:50] 0.131 0.083 0.122 0.146 0.048 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ snp     : chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ position: int [1:50] 1 2 3 4 5 6 7 8 9 10 ...
##  $ N       : int 1000
##  $ pvalues : Named num [1:50] 4.78e-04 3.45e-03 9.70e-05 7.68e-09 5.94e-05 ...
##   ..- attr(*, "names")= chr [1:50] "s1" "s2" "s3" "s4" ...
##  $ type    : chr "cc"
##  $ s       : num 0.5</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">nobeta_ccdata</span><span class="op">)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Note that coloc doesn’t mind if your dataset has more entries than it minimally needs, it will use what it needs, preferring supplied beta/varbeta and sdY over estimation, and leave the rest.</p>
</div>
<div id="additional-ld-information-for-coloc-susie" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-ld-information-for-coloc-susie" class="anchor"></a>Additional LD information for <code>coloc.susie</code>
</h2>
<p><code>coloc.abf</code> makes the simplifying assumption that each trait has at most one causal variant in the region under consideration. This means it does not need to know about correlation (LD) between SNPs, because no model under consideration has two or more SNPs in it. <code>coloc.susie</code> extends the functionality by allowing more than one causal variant, but this means it needs to know the LD between the SNPs. You may be able to get this from the study data, but if not, reference data such as 1000 Genomes can be used.</p>
<p>Our test data has an LD matrix already. This will be a square numeric matrix of dimension equal to the number of SNPs, with dimnames corresponding to the SNP ids.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">D1</span><span class="op">$</span><span class="va">LD</span><span class="op">)</span></code></pre></div>
<pre><code>##  num [1:50, 1:50] 1 0.732 0.805 0.763 0.541 ...
##  - attr(*, "dimnames")=List of 2
##   ..$ : chr [1:50] "s1" "s2" "s3" "s4" ...
##   ..$ : chr [1:50] "s1" "s2" "s3" "s4" ...</code></pre>
<div id="nb-studies-from-different-populations" class="section level3">
<h3 class="hasAnchor">
<a href="#nb-studies-from-different-populations" class="anchor"></a>NB studies from different populations</h3>
<p>One of the nice things about <code>coloc.abf</code> is that it does not assume that LD structures are similar between studies, as long as there is a dense map of SNPs across the region. The same thing still applies to <code>coloc.susie</code>, just add an appropriate LD matrix to each study.</p>
</div>
<div id="nb-allele-order-matters" class="section level3">
<h3 class="hasAnchor">
<a href="#nb-allele-order-matters" class="anchor"></a>NB allele order matters!</h3>
<p>beta coefficients in GWAS studies report the effect of one allele with respect to the other. That is, if you see results looking like</p>
<table class="table">
<thead><tr class="header">
<th>CHR38</th>
<th>BP38</th>
<th>REF</th>
<th>ALT</th>
<th>SNPID</th>
<th>P</th>
<th>BETA</th>
<th>SE</th>
<th>maf</th>
<th>maf_cases</th>
<th>maf_controls</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2101817</td>
<td>G</td>
<td>A</td>
<td>rs908742</td>
<td>0.0826</td>
<td>0.0749</td>
<td>0.0432</td>
<td>0.4394</td>
<td>0.456</td>
<td>0.4391</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>2109497</td>
<td>T</td>
<td>C</td>
<td>rs4648808</td>
<td>0.8695</td>
<td>-0.0144</td>
<td>0.0877</td>
<td>0.9347</td>
<td>0.9344</td>
<td>0.9347</td>
<td></td>
</tr>
<tr class="odd">
<td>1</td>
<td>2126584</td>
<td>A</td>
<td>G</td>
<td>rs3128291</td>
<td>0.7334</td>
<td>-0.0306</td>
<td>0.0897</td>
<td>0.939</td>
<td>0.9371</td>
<td>0.9391</td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>2137467</td>
<td>G</td>
<td>T</td>
<td>rs3128296</td>
<td>0.8802</td>
<td>-0.0124</td>
<td>0.0826</td>
<td>0.9268</td>
<td>0.9267</td>
<td>0.9268</td>
<td></td>
</tr>
<tr class="odd">
<td>1</td>
<td>2139901</td>
<td>C</td>
<td>A</td>
<td>rs424079</td>
<td>0.6399</td>
<td>-0.0207</td>
<td>0.0442</td>
<td>0.6347</td>
<td>0.6269</td>
<td>0.6348</td>
<td></td>
</tr>
</tbody>
</table>
<p>the beta is telling you about the effect of allele A compared to allele G at the snp rs908742. If the alleles were reversed, beta would be -0.0826. The LD matrix needs to be aligned the same way. This will be easy if you have the GWAS data and are making the LD matrix yourself. If you get it from a public source, it will almost certainly be telling you about the LD between non-reference alleles. In this case, you need to make sure your data is also listing the non-reference allele as the “alternative” or “risk” allele. If it is not, switch the sign of beta.</p>
<p>To avoid hassles, I recommend: * if using GWAS catalog data, download the <a href="https://www.ebi.ac.uk/gwas/docs/methods/summary-statistics"><em>harmonised</em> version</a> which will do this for you. * if using eQTL summary data that has been processed by the <a href="https://www.ebi.ac.uk/gwas/docs/methods/summary-statistics">eQTL catalogue</a>, use that version because it will also be harmonised * Otherwise, check the alleles in your summary table match those in the information files from the LD source * Finally, always plot the coloc result with the <a href="a04_sensitivity.html"><code>sensitivity</code> function</a> because weird effects are much easier to understand visually</p>
<p>You can also use the coloc function <code>check_alignment</code> as a visual guide. It comparse the product of the Z scores for all SNP pairs against their correlation, and plots a histogram of this ratio for SNPs in some degree of LD. We do not expect to see strongly negative products of Z scores for strongly positive correlations or vice versa. Therefore this plot <em>should be</em> skewed to have more positive values than negative. Here I show a good (left) and bad (right) example.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/check_alignment.html">check_alignment</a></span><span class="op">(</span><span class="va">goodD</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">200</span>,<span class="st">"good"</span>,col<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/check_alignment.html">check_alignment</a></span><span class="op">(</span><span class="va">badD</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.4915591</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>,<span class="st">"bad"</span>,col<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<p><img src="a02_data_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chris Wallace, Claudia Giambartolomei.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
